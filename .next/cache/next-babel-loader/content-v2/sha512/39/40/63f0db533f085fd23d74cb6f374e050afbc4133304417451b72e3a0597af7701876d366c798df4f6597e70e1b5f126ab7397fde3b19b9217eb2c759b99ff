{"ast":null,"code":"import dbconnect from \"../../../mongoose/mongoose\";\nimport graph from \"../../../mongoose/models/graph\";\nimport form from \"../../../mongoose/models/form\";\ndbconnect();\n\nconst getit = async (label, id) => {\n  const ss = await graph.find({\n    formId: id,\n    ques: label\n  }).exec();\n  return ss;\n};\n\nconst getgraph = async (data, id) => {\n  const newdata = [];\n\n  if (data) {\n    for (let i = 0; i < data[0].tools.length; i++) {\n      const tool = data[0].tools[i];\n      const da = await getit(tool.label, id);\n      newdata.push({\n        label: tool.label,\n        options: da\n      });\n    }\n  }\n\n  return newdata;\n};\n\nconst handlegraphshape = async (id, res) => {\n  const data = await form.find({\n    _id: id\n  }).exec();\n  return data;\n};\n\nexport default (async (req, res) => {\n  const {\n    method,\n    query\n  } = req;\n\n  switch (method) {\n    case \"GET\":\n      try {\n        const data = await handlegraphshape(query.id);\n        const newdata = await getgraph(data, query.id);\n        res.json(newdata);\n      } catch (error) {\n        console.log(\"err\", error);\n        res.status(404).json({\n          sucees: false\n        });\n      }\n\n      break;\n\n    default:\n      break;\n  }\n});","map":{"version":3,"sources":["D:/upwork projects/New folder (4)/form-projet-finale/pages/api/findgraph/[id].js"],"names":["dbconnect","graph","form","getit","label","id","ss","find","formId","ques","exec","getgraph","data","newdata","i","tools","length","tool","da","push","options","handlegraphshape","res","_id","req","method","query","json","error","console","log","status","sucees"],"mappings":"AAAA,OAAOA,SAAP,MAAsB,4BAAtB;AACA,OAAOC,KAAP,MAAkB,gCAAlB;AACA,OAAOC,IAAP,MAAiB,+BAAjB;AACAF,SAAS;;AAET,MAAMG,KAAK,GAAG,OAAOC,KAAP,EAAcC,EAAd,KAAqB;AAClC,QAAMC,EAAE,GAAG,MAAML,KAAK,CAACM,IAAN,CAAW;AAAEC,IAAAA,MAAM,EAAEH,EAAV;AAAcI,IAAAA,IAAI,EAAEL;AAApB,GAAX,EAAwCM,IAAxC,EAAjB;AACA,SAAOJ,EAAP;AACA,CAHD;;AAKA,MAAMK,QAAQ,GAAG,OAAOC,IAAP,EAAaP,EAAb,KAAoB;AACpC,QAAMQ,OAAO,GAAG,EAAhB;;AACA,MAAID,IAAJ,EAAU;AACT,SAAK,IAAIE,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGF,IAAI,CAAC,CAAD,CAAJ,CAAQG,KAAR,CAAcC,MAAlC,EAA0CF,CAAC,EAA3C,EAA+C;AAC9C,YAAMG,IAAI,GAAGL,IAAI,CAAC,CAAD,CAAJ,CAAQG,KAAR,CAAcD,CAAd,CAAb;AACA,YAAMI,EAAE,GAAG,MAAMf,KAAK,CAACc,IAAI,CAACb,KAAN,EAAaC,EAAb,CAAtB;AACAQ,MAAAA,OAAO,CAACM,IAAR,CAAa;AAAEf,QAAAA,KAAK,EAAEa,IAAI,CAACb,KAAd;AAAqBgB,QAAAA,OAAO,EAAEF;AAA9B,OAAb;AACA;AACD;;AACD,SAAOL,OAAP;AACA,CAVD;;AAYA,MAAMQ,gBAAgB,GAAG,OAAOhB,EAAP,EAAWiB,GAAX,KAAmB;AAC3C,QAAMV,IAAI,GAAG,MAAMV,IAAI,CAACK,IAAL,CAAU;AAAEgB,IAAAA,GAAG,EAAElB;AAAP,GAAV,EAAuBK,IAAvB,EAAnB;AAEA,SAAOE,IAAP;AACA,CAJD;;AAMA,gBAAe,OAAOY,GAAP,EAAYF,GAAZ,KAAoB;AAClC,QAAM;AAAEG,IAAAA,MAAF;AAAUC,IAAAA;AAAV,MAAoBF,GAA1B;;AACA,UAAQC,MAAR;AACC,SAAK,KAAL;AACC,UAAI;AACH,cAAMb,IAAI,GAAG,MAAMS,gBAAgB,CAACK,KAAK,CAACrB,EAAP,CAAnC;AACA,cAAMQ,OAAO,GAAG,MAAMF,QAAQ,CAACC,IAAD,EAAOc,KAAK,CAACrB,EAAb,CAA9B;AACAiB,QAAAA,GAAG,CAACK,IAAJ,CAASd,OAAT;AACA,OAJD,CAIE,OAAOe,KAAP,EAAc;AACfC,QAAAA,OAAO,CAACC,GAAR,CAAY,KAAZ,EAAmBF,KAAnB;AACAN,QAAAA,GAAG,CAACS,MAAJ,CAAW,GAAX,EAAgBJ,IAAhB,CAAqB;AAAEK,UAAAA,MAAM,EAAE;AAAV,SAArB;AACA;;AACD;;AAED;AACC;AAbF;AAeA,CAjBD","sourcesContent":["import dbconnect from \"../../../mongoose/mongoose\";\r\nimport graph from \"../../../mongoose/models/graph\";\r\nimport form from \"../../../mongoose/models/form\";\r\ndbconnect();\r\n\r\nconst getit = async (label, id) => {\r\n\tconst ss = await graph.find({ formId: id, ques: label }).exec();\r\n\treturn ss;\r\n};\r\n\r\nconst getgraph = async (data, id) => {\r\n\tconst newdata = [];\r\n\tif (data) {\r\n\t\tfor (let i = 0; i < data[0].tools.length; i++) {\r\n\t\t\tconst tool = data[0].tools[i];\r\n\t\t\tconst da = await getit(tool.label, id);\r\n\t\t\tnewdata.push({ label: tool.label, options: da });\r\n\t\t}\r\n\t}\r\n\treturn newdata;\r\n};\r\n\r\nconst handlegraphshape = async (id, res) => {\r\n\tconst data = await form.find({ _id: id }).exec();\r\n\r\n\treturn data;\r\n};\r\n\r\nexport default async (req, res) => {\r\n\tconst { method, query } = req;\r\n\tswitch (method) {\r\n\t\tcase \"GET\":\r\n\t\t\ttry {\r\n\t\t\t\tconst data = await handlegraphshape(query.id);\r\n\t\t\t\tconst newdata = await getgraph(data, query.id);\r\n\t\t\t\tres.json(newdata);\r\n\t\t\t} catch (error) {\r\n\t\t\t\tconsole.log(\"err\", error);\r\n\t\t\t\tres.status(404).json({ sucees: false });\r\n\t\t\t}\r\n\t\t\tbreak;\r\n\r\n\t\tdefault:\r\n\t\t\tbreak;\r\n\t}\r\n};\r\n"]},"metadata":{},"sourceType":"module"}